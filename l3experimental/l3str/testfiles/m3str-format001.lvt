%
% Copyright (C) 2012 LaTeX3 Project
%

\documentclass{minimal}
\input{regression-test}
\RequirePackage[log-functions, check-declarations]{expl3}
\RequirePackage{l3str-format}

\begin{document}

\START
\AUTHOR{Bruno Le Floch}
\ExplSyntaxOn

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TESTEXP { Formatting~token~lists }
  {
    | \tl_format:nn { abcdef } {          } | \NEWLINE
    | \tl_format:nn { abcdef } {    9     } | \NEWLINE
    | \tl_format:nn { abcdef } {   18     } | \NEWLINE
    | \tl_format:nn { abcdef } {    8.3   } | \NEWLINE
    | \tl_format:nn { abcdef } {  < 8.3   } | \NEWLINE
    | \tl_format:nn { abcdef } {  ^ 8.3   } | \NEWLINE
    | \tl_format:nn { abcdef } {  > 8.3   } | \NEWLINE
    | \tl_format:nn { abcdef } { .< 8.3   } | \NEWLINE
    | \tl_format:nn { abcdef } { .^ 8.3   } | \NEWLINE
    | \tl_format:nn { abcdef } { .> 8.3 s } | \NEWLINE
    | \tl_format:nn { abcdef } { >> 8.3 s } | \NEWLINE
    | \tl_format:nn { abcdef } { ^< 8.3 s } | \NEWLINE
    | \tl_format:nn { abcdef } { ^< 8.0 s } | \NEWLINE
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TESTEXP { Formatting~token~list~(empty~and~spaces) }
  {
    | \tl_format:nn { } {          } | \NEWLINE
    | \tl_format:nn { } {    9     } | \NEWLINE
    | \tl_format:nn { } {   18     } | \NEWLINE
    | \tl_format:nn { } {    8.3   } | \NEWLINE
    | \tl_format:nn { } {  < 8.3   } | \NEWLINE
    | \tl_format:nn { } {  ^ 8.3   } | \NEWLINE
    | \tl_format:nn { } {  > 8.3   } | \NEWLINE
    | \tl_format:nn {~} { .< 8.3   } | \NEWLINE
    | \tl_format:nn {~} { .^ 8.3   } | \NEWLINE
    | \tl_format:nn {~} { .> 8.3 s } | \NEWLINE
    | \tl_format:nn {~} { >> 8.3 s } | \NEWLINE
    | \tl_format:nn {~} { ^< 8.3 s } | \NEWLINE
    | \tl_format:nn {~} { ^< 8.0 s } | \NEWLINE
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TESTEXP { Invalid~formattings~for~token~lists }
  {
    | \tl_format:nn { abcdef } { =  } | \NEWLINE
    | \tl_format:nn { abcdef } { +  } | \NEWLINE
    | \tl_format:nn { abcdef } { ~  } | \NEWLINE
    | \tl_format:nn { abcdef } { -  } | \NEWLINE
    | \tl_format:nn { abcdef } { .- } | \NEWLINE
    | \tl_format:nn { abcdef } { ?  } | \NEWLINE % no error :(
    | \tl_format:nn { abcdef } { < > . . } | \NEWLINE
    | \tl_format:nn { abcdef } { + 8.3 t } | \NEWLINE
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\seq_set_split:Nnn \l_tmpa_seq { , } { abc , defghij , k }
\TESTEXP { Formatting~sequences }
  {
    | \seq_format:Nn \l_tmpa_seq {          } | \NEWLINE
    | \seq_format:Nn \l_tmpa_seq {    9     } | \NEWLINE
    | \seq_format:Nn \l_tmpa_seq {   18     } | \NEWLINE
    | \seq_format:Nn \l_tmpa_seq {    8.3   } | \NEWLINE
    | \seq_format:Nn \l_tmpa_seq {  < 8.3   } | \NEWLINE
    | \seq_format:Nn \l_tmpa_seq {  ^ 8.3   } | \NEWLINE
    | \seq_format:Nn \l_tmpa_seq {  > 8.3   } | \NEWLINE
    | \seq_format:Nn \l_tmpa_seq { .< 8.3   } | \NEWLINE
    | \seq_format:Nn \l_tmpa_seq { .^ 8.3   } | \NEWLINE
    | \seq_format:Nn \l_tmpa_seq { .> 8.3 s } | \NEWLINE
    | \seq_format:Nn \l_tmpa_seq { >> 8.3 s } | \NEWLINE
    | \seq_format:Nn \l_tmpa_seq { ^< 8.3 s } | \NEWLINE
    | \seq_format:Nn \l_tmpa_seq { ^< 8.0 s } | \NEWLINE
  }

\END
