%
% Copyright (C) 2012,2015 The LaTeX3 Project
%
\documentclass{minimal}
\input{regression-test}
\RequirePackage[check-declarations,log-functions]{expl3}

\begin{document}

\START
\AUTHOR{Will Robertson}
\ExplSyntaxOn

\tl_new:N \l_A_tl  \tl_set:Nn \l_A_tl { Abc }
\tl_new:N \l_B_tl  \tl_set:Nn \l_B_tl { Bcd }
\tl_new:N \l_C_tl  \tl_set:Nn \l_C_tl { Cde }
\tl_new:N \g_A_tl  \tl_gset:Nn \g_A_tl { Abc }
\tl_new:N \g_B_tl  \tl_gset:Nn \g_B_tl { Bcd }
\tl_new:N \g_C_tl  \tl_gset:Nn \g_C_tl { Cde }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST { tl~sow/reap }
  {
    {
      \tl_sow_prepare:N \l_A_tl
      \tl_log:N  \l_A_tl
      \tl_sow:Nn \l_A_tl {A1}
      \tl_log:N  \l_A_tl
      \tl_sow:Nn \l_A_tl {A2}
      \tl_sow:Nn \l_A_tl {A3}
      \tl_sow:Nn \l_A_tl {A4}
      \tl_sow_reap:N \l_A_tl
      \tl_log:N  \l_A_tl
    }
    \tl_log:N \l_A_tl
  }
  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST { tl~gsow/reap }
  {
    {
      \tl_gsow_prepare:N \g_A_tl
      \tl_log:N  \g_A_tl
      \tl_gsow:Nn \g_A_tl {A1}
      \tl_log:N  \g_A_tl
      \tl_gsow:Nn \g_A_tl {A2}
      \tl_gsow:Nn \g_A_tl {A3}
      \tl_gsow:Nn \g_A_tl {A4}
      \tl_gsow_greap:N \g_A_tl
      \tl_log:N  \g_A_tl
    }
    \tl_log:N \g_A_tl
  }
  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST { tl~gsow/reap~2 }
  {
    {
      \tl_gsow_prepare:N \g_A_tl
      \tl_log:N  \g_A_tl
      \tl_gsow:Nn \g_A_tl {A1}
      \tl_log:N  \g_A_tl
      \tl_gsow:Nn \g_A_tl {A2}
      \tl_gsow:Nn \g_A_tl {A3}
      \tl_gsow:Nn \g_A_tl {A4}
    }
    \tl_gsow_greap:N \g_A_tl
    \tl_log:N \g_A_tl
  }
  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST { tl~sow/reap~interleaved }
  {
    {
      \tl_sow_prepare:N \l_A_tl
      \tl_sow_prepare:N \l_B_tl
      \tl_log:N  \l_A_tl
      \tl_log:N  \l_B_tl
      \tl_sow:Nn \l_A_tl {A1}
      \tl_sow:Nn \l_B_tl {B1}
      \tl_sow:Nn \l_A_tl {A2}
      \tl_sow:Nn \l_B_tl {B2}
      \tl_sow:Nn \l_A_tl {A3}
      \tl_sow:Nn \l_B_tl {B3}
      \tl_sow_reap:N \l_A_tl
      \tl_sow_reap:N \l_B_tl
      \tl_log:N  \l_A_tl
      \tl_log:N  \l_B_tl
    }
    \tl_log:N \l_A_tl
    \tl_log:N \l_B_tl
  }
  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST { tl~gsow/reap~interleaved }
  {
    {
      \tl_gsow_prepare:N \g_A_tl
      \tl_gsow_prepare:N \g_B_tl
      \tl_log:N  \g_A_tl
      \tl_log:N  \g_B_tl
      \tl_gsow:Nn \g_A_tl {A1}
      \tl_gsow:Nn \g_B_tl {B1}
      \tl_gsow:Nn \g_A_tl {A2}
      \tl_gsow:Nn \g_B_tl {B2}
      \tl_gsow:Nn \g_A_tl {A3}
      \tl_gsow:Nn \g_B_tl {B3}
      \tl_gsow_greap:N \g_A_tl
      \tl_gsow_greap:N \g_B_tl
      \tl_log:N  \g_A_tl
      \tl_log:N  \g_B_tl
    }
    \tl_log:N \g_A_tl
    \tl_log:N \g_B_tl
  }
  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST { tl~gsow/reap~interleaved~2 }
  {
    {
      \tl_gsow_prepare:N \g_A_tl
      \tl_gsow_prepare:N \g_B_tl
      \tl_log:N  \g_A_tl
      \tl_log:N  \g_B_tl
      \tl_gsow:Nn \g_A_tl {A1}
      \tl_gsow:Nn \g_B_tl {B1}
      \tl_gsow:Nn \g_A_tl {A2}
      \tl_gsow:Nn \g_B_tl {B2}
      \tl_gsow:Nn \g_A_tl {A3}
      \tl_gsow:Nn \g_B_tl {B3}
    }
    \tl_gsow_greap:N \g_A_tl
    \tl_gsow_greap:N \g_B_tl
    \tl_log:N  \g_A_tl
    \tl_log:N  \g_B_tl
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST { tl~sow/reap~empty }
  {
    {
      \tl_sow_prepare:N \l_C_tl
      \tl_log:N  \l_C_tl
      \tl_sow_reap:N \l_C_tl
      \tl_log:N  \l_C_tl
    }
    \tl_log:N  \l_C_tl
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST { tl~gsow/reap~empty }
  {
    {
      \tl_gsow_prepare:N \g_C_tl
      \tl_log:N  \g_C_tl
      \tl_gsow_greap:N \g_C_tl
      \tl_log:N  \g_C_tl
    }
    \tl_log:N  \g_C_tl
  }


\END
