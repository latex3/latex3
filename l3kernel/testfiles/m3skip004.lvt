%
% Copyright (C) 2011,2012,2014 The LaTeX3 Project
%

\documentclass{minimal}
\input{regression-test}

\RequirePackage[check-declarations,log-functions]{expl3}


\begin{document}

\START
\AUTHOR{LaTeX3 Project}
\ExplSyntaxOn

\TESTEXP { Dimension~expressions~with~potentially~no~units }
  {
    \__dim_strip_pt:n { 1 pt } \NEWLINE
    \__dim_strip_pt:n { 1 bp } \NEWLINE
    \__dim_strip_pt:n { 3 pt + 4 pt } \NEWLINE
  }

\TEST { Setting~a~dimension~if~smaller/bigger }
  {
    \dim_zero:N \l_tmpa_dim
    \dim_set:Nn \l_tmpa_dim { \dim_min:nn \l_tmpa_dim { 1pt } }
      \TYPE { \dim_use:N \l_tmpa_dim }
    \dim_zero:N \l_tmpa_dim
    \dim_set:Nn \l_tmpa_dim { \dim_max:nn \l_tmpa_dim { 1pt } }
      \TYPE { \dim_use:N \l_tmpa_dim }
    \dim_zero:N \l_tmpa_dim
    \dim_set:Nn \l_tmpa_dim { \dim_max:nn \l_tmpa_dim { -1pt } }
      \TYPE { \dim_use:N \l_tmpa_dim }
    \dim_zero:N \l_tmpa_dim
    \dim_set:Nn \l_tmpa_dim { \dim_min:nn \l_tmpa_dim { -1pt } }
      \TYPE { \dim_use:N \l_tmpa_dim }
  }

\TESTEXP { Strip~big~point~unit }
  {
    \__dim_strip_bp:n { 1.1234 pt } \NEWLINE
    \__dim_strip_bp:n { 1.1234 bp } \NEWLINE
    \__dim_strip_bp:n { 3 pt + 4 pt } \NEWLINE
  }

\TESTEXP { Convert~to~pt }
  {
    \dim_to_pt:n { 1.1234 pt } \NEWLINE
    \dim_to_pt:n { 1.1234 bp } \NEWLINE
    \dim_to_pt:n { 3 pt + 4 pt } \NEWLINE
  }

\TESTEXP { Convert~to~unit }
  {
    \dim_to_unit:nn { 1.1234 pt } { 1bp + .1234bp } \NEWLINE
    \dim_to_unit:nn { 1.1234 bp } { 1.1234 pt } \NEWLINE
    \dim_to_unit:nn { 3 pt + 4 pt } { 2pt * 2 } \NEWLINE
  }

\TEST { Bad~conversions }
  {
    \tl_set:Nx \l_tmpa_tl
      {
        \__dim_strip_pt:n { 4 pt pt }
        \__dim_strip_bp:n { 4 pt pt }
        \dim_to_pt:n { 4 pt pt }
        \dim_to_unit:nn { 4 pt pt } { 3 pt pt }
      }
    % Do nothing with the tl: it contains internals of those functions.
  }
\END



