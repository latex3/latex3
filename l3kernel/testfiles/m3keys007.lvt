% Copyright (C) 2021 The LaTeX Project


\documentclass{minimal}
\input{regression-test}

\RequirePackage[enable-debug]{expl3}
\ExplSyntaxOn
\debug_on:n { check-declarations , deprecation , log-functions }
\ExplSyntaxOff


\begin{document}
\START
\AUTHOR{Joseph Wright}
\ExplSyntaxOn

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\TEST { .validity:n ~ basics }
  {
    \keys_define:nn { module }
      {
        key-one .code:n  = #1 ,
        key-one .validity:n = load ,
        key-two .code:n  = #1 ,
        key-two .validity:n = preamble ,
        key-three .code:n  = #1 ,
        key-three .validity:n = general ,
        key-four .code:n  = #1 ,
        key-four .validity:n = oops
      }
    \prop_show:N \l_keys_validity_load_prop
    \prop_show:N \l_keys_validity_preamble_prop
  }

\TEST { .usage:n ~ adding ~ and ~ removing }
  {
    \keys_define:nn { module }
      {
        key-one .code:n  = #1 ,
        key-one .validity:n = load ,
        key-two .code:n  = #1 ,
        key-two .validity:n = load ,
        key-three .code:n  = #1 ,
        key-three .validity:n = load ,
        key-three .validity:n = preamble ,
        key-four .code:n  = #1 ,
        key-four .validity:n = load ,
        key-four .validity:n = general
      }
    \prop_show:N \l_keys_validity_load_prop
    \prop_show:N \l_keys_validity_preamble_prop
  }

\END
