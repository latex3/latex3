%
% Copyright (C) 2012 LaTeX3 Project
%

\documentclass{minimal}
\input{regression-test}

\RequirePackage[check-declarations,log-functions]{expl3}

\begin{document}
\START
\AUTHOR{Bruno Le Floch}
\ExplSyntaxOn

\OMIT
\msg_new:nnnn { foo } { use-args }
  { (#1)~(#2)~(#3)~(#4) }
  { [#1]~[#2]~[#3]~[#4] }
\__msg_kernel_new:nnnn { kernel } { use-args }
  { (#1)~(#2)~(#3)~(#4) }
  { [#1]~[#2]~[#3]~[#4] }
\TIMO

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST { Kernel~fatal~all~arg~types }
  {
    % Redefine \tex_end:D to avoid ending the run.
    \cs_set_protected:Npn \tex_end:D { \TYPE { tex_end:D } }
    \tl_map_inline:nn
      { {nnnnnn} {nnnnn} {nnnn} {nnn} {nn} {nnx} {nnxx} {nnxxx} {nnxxxx} }
      {
        \TYPE {|__msg_kernel_fatal:#1|}
        \use:c { __msg_kernel_fatal:#1 } { kernel } { use-args }
          { \exp_not:n { \exp_not:N \c_empty_tl } }
          { \exp_not:N \c_empty_tl }
          { \c_empty_tl }
          { }
      }
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST { Various~kernel~classes }
  {
    \tl_map_inline:nn
      { {error} {warning} {info} }
      {
        \TYPE {|__msg_kernel_#1:nnnnnn~and~__msg_kernel_#1:nnxxxx|}
        \use:c { __msg_kernel_#1:nnnnnn } { kernel } { use-args }
          { \exp_not:n { \exp_not:N \c_empty_tl } }
          { \exp_not:N \c_empty_tl }
          { \c_empty_tl }
          { }
        \use:c { __msg_kernel_#1:nnxxxx } { kernel } { use-args }
          { \exp_not:n { \exp_not:N \c_empty_tl } }
          { \exp_not:N \c_empty_tl }
          { \c_empty_tl }
          { }
      }
    \TYPE {|__msg_kernel_expandable_error:nnnnnn|}
    \__msg_kernel_expandable_error:nnnnnn { kernel } { use-args }
      { \exp_not:n { \exp_not:N \c_empty_tl } }
      { \exp_not:N \c_empty_tl }
      { \c_empty_tl }
      { }
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST { Various~non-kernel~classes }
  {
    % Redefine \tex_end:D and \tex_endinput:D to prevent
    % 'fatal' and 'critical' errors from doing their thing.
    \cs_set_protected:Npn \tex_end:D { \TYPE { tex_end:D } }
    \cs_set_protected:Npn \tex_endinput:D { \TYPE { tex_endinput:D } }
    \tl_map_inline:nn
      { {fatal} {critical} {error} {warning} {info} {log} {none} }
      {
        \TYPE {|msg_#1:nnnnnn~and~msg_#1:nnxxxx|}
        \use:c { msg_#1:nnnnnn } { foo } { use-args }
          { \exp_not:n { \exp_not:N \c_empty_tl } }
          { \exp_not:N \c_empty_tl }
          { \c_empty_tl }
          { }
        \use:c { msg_#1:nnxxxx } { foo } { use-args }
          { \exp_not:n { \exp_not:N \c_empty_tl } }
          { \exp_not:N \c_empty_tl }
          { \c_empty_tl }
          { }
      }
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\END

