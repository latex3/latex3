% \iffalse
%% File xfm-test-cls.dtx
%% (C) Copyright 2001, 2004 Frank Mittelbach, LaTeX3 Project
%%
%% It may be distributed and/or modified under the conditions of the
%% LaTeX Project Public License (LPPL), either version 1.3c of this
%% license or (at your option) any later version.  The latest version
%% of this license is in the file
%%
%%    http://www.latex-project.org/lppl.txt
%%
%% This file is part of the ``xfrontm bundle'' (The Work in LPPL)
%% and all files in that bundle must be distributed together.
%%
%% The released version of this bundle is available from CTAN.
%%
%% -----------------------------------------------------------------------
%%
%% The development version of the bundle can be found at
%%
%%    http://www.latex-project.org/cgi-bin/cvsweb.cgi/
%%
%% for those people who are interested.
%%
%%%%%%%%%%%
%% NOTE: %%
%%%%%%%%%%%
%%
%%   Snapshots taken from the repository represent work in progress and may
%%   not work or may contain conflicting material!  We therefore ask
%%   people _not_ to put them into distributions, archives, etc. without
%%   prior consultation with the LaTeX Project Team.
%%
%% -----------------------------------------------------------------------
%%
\RequirePackage{expl3}
\GetIdInfo$Id$
       {sample frontmatter layout class}
%<aip>\ProvidesExplClass{xfm-aip}{\filedate}{\fileversion}{\filedescription}
%<arlo>\ProvidesExplClass{xfm-arlo}{\filedate}{\fileversion}{\filedescription}
%<plain>\ProvidesExplClass{xfm-plain}{\filedate}{\fileversion}{\filedescription}
%<tub>\ProvidesExplClass{xfm-tub}{\filedate}{\fileversion}{\filedescription}
%<wiley>\ProvidesExplClass{xfm-wiley}{\filedate}{\fileversion}{\filedescription}
%<driver>\ProvidesFile{\filename.drv}
%
%<*driver>
 \documentclass{ltxdoc}
%
 \begin{document}
 \DocInput{xfm-test-cls.dtx}
 \end{document}
%</driver>
%
% \fi
%
%
%
% \title{The \textsf{xfm} test classes\thanks{This file
%         has version number \fileversion, last
%         revised \filedate.}}
% \author{FMi}
% \date{\filedate}
%
%  \maketitle
%
% \tableofcontents
%
%
% \begin{abstract}
%    This file contains sample layouts using the new frontmatter
%    macros --- none of them are finished and all of them probably
%    contain dead code.
%
%    It is basically undocumented---explanation on the used
%    declarations can be found in \texttt{xfm.dtx}.
% \end{abstract}
%
%
% \section{The overall class command structure}
%
%    The front matter structure is common to all sample classes since
%    after all we want to be able to exchange one layout with another.
%    \begin{macrocode}
\LoadClass{article}
%    \end{macrocode}
%
%    These have to come first because of syntax problems (e.g., colon
%    in |\@for|) \ldots
%    \begin{macrocode}
%%\RequirePackage{trace}
\RequirePackage{graphicx}
\RequirePackage{times}
%    \end{macrocode}
%
%    \begin{macrocode}
\RequirePackage{xfm}
%    \end{macrocode}
%
%    \begin{macrocode}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% XFM Structure Setup (articles)                                    %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareFMStructure{articleinfo}
 {
   accepted-keyword-list =
      {title,shorttitle,subtitle,thanks,abstract},
 }


\DeclareFMStructure{authorinfo}
 {
   accepted-keyword-list =
      {name,title,shortname,address,altaddress,email,homepage,%
       thanks,biography,picture},
 }
%    \end{macrocode}
%
%
%
% \section{The plain class}
%
%    This layout is similar to that of standard \LaTeX{}'s article
%    class though there are differences.
%
%    \begin{macrocode}
%<*plain>
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM measure setup                                                %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM Text Area setup                                              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareFMArea{title}
 {
  area-required-boolean    = true,
  area-bb-skip             = 30pt,
  text-font                = \huge\bfseries,
  text-justification-setup = center,
 }

\DeclareFMArea{subtitle}
 {
  area-required-boolean    = true,
  area-bb-skip             = 16pt,
  text-font                = \Large\bfseries,
  text-justification-setup = center,
 }

\DeclareFMArea{authors}
 {
  area-required-boolean    = true,
  area-bb-skip             = 32pt,
  text-font                = \large\normalfont\lineskip .75em\relax,
  text-justification-setup = center,
 }

\DeclareFMArea{date}
 {
  area-required-boolean    = true,
  area-bb-skip             = 16pt,
  text-font                = \large\normalfont,
  text-justification-setup = center,
 }

\DeclareFMArea{thanks}
 {
  area-required-boolean    = false,
  area-bb-skip             = 10pt,
  text-font                = \fontsize{8}{10}\normalfont,
  text-justification-setup = flushleft,
 }

%%% bug: \thanks is currently not handled properly in the abstract

\DeclareFMArea{abstract}
 {
  area-required-boolean    = false,
  area-bb-skip             = 28pt,
  head-font                = \fontsize{9}{10}\bfseries,
  head-text                = Abstract,
  head-format              = #1.,
  head-text-h-skip         = 6pt,
  text-font                = \fontsize{9}{10}\normalfont,
  text-justification-setup = default,
  text-firstindent-boolean = false,
 }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM Text Marker setup                                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareFMMarker{thanks}
 {
   marker-type   = \arabic,
   default-format = \textsuperscript{\normalfont#1},
 }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM authorinfo setup                                             %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareFMKeyword{authorinfo}{name}
 {
  value-required-boolean = true,
  value-targetarea-id   = authors,
  marker-id        = ,
  value-format     = \textbf{#1},
 }


\DeclareFMKeyword{authorinfo}{thanks}
 {
  value-required-boolean = false,
  value-targetarea-id   = thanks,
  marker-id        = thanks,
  value-combine-boolean  = false,
 }


\DeclareFMKeyword{authorinfo}{address}
 {
  value-required-boolean = true,
  value-targetarea-id   = authors,
  marker-id        = ,
  value-format     = \XFMSplitOnComma{#1}{\\}{\textup},
 }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM articleinfo setup                                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareFMKeyword{articleinfo}{title}
 {
  value-required-boolean = true,
  value-targetarea-id   = title,
  marker-id        = ,
  value-combine-boolean  = false,
  value-format     = \textbf{#1},
 }
\DeclareFMKeyword{articleinfo}{subtitle}
 {
  value-required-boolean = false,
  value-targetarea-id   = title,
  marker-id        = ,
  value-combine-boolean  = false,
 }
\DeclareFMKeyword{articleinfo}{short-title}
 {
  value-required-boolean = false,
  value-targetarea-id   = title,
  marker-id        = ,
  value-combine-boolean  = false,
 }

\DeclareFMKeyword{articleinfo}{thanks}
 {
  value-required-boolean = false,
  marker-sourcearea-id   = title,
  value-targetarea-id   = thanks,
  marker-id        = thanks,
  value-combine-boolean  = false,
 }

\DeclareFMKeyword{articleinfo}{abstract}
 {
  value-required-boolean = false,
  value-targetarea-id   = abstract,
  marker-id        = ,
  value-combine-boolean  = false,
 }



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM elementseparation setup                                      %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\DeclareFMObjectSep{authors}{START}        {key!name}     {\begin{tabular}[t]{c}}
\DeclareFMObjectSep{authors}{*}            {key!name}     {\end{tabular}\hfill\begin{tabular}[t]{c}}
\DeclareFMObjectSep{authors}{*}            {END}          {\end{tabular}}
\DeclareFMObjectSep{authors}{*}            {key!address}  {\\}

\DeclareFMObjectSep{authors}{*}            {marker!thanks}{\hbox to0pt\bgroup\,}
\DeclareFMObjectSep{authors}{marker!thanks}{marker!thanks}{\textsuperscript{,}}
\DeclareFMObjectSep{authors}{marker!thanks}{*}            {\hss\egroup}

\DeclareFMObjectSep{authors}{*}            {key!email}    {\\}
\DeclareFMObjectSep{authors}{*}            {*}            {\space }

\DeclareFMObjectSep{thanks} {START}        {*}     {}
\DeclareFMObjectSep{thanks} {marker!thanks}{*}     {\space}
\DeclareFMObjectSep{thanks} {*}            {*}     {\endgraf}
\DeclareFMObjectSep{thanks} {*}            {END}   {\strut\endgraf}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM title setup                                                  %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareInstance{titlesetup}{maketitle}{std}{
   articleinfo-keyword-list = {title,thanks,abstract},
   authorinfo-keyword-list  = {name,email,homepage,thanks,address},
   top-areas-list           = {title,authors,abstract},
   footins-areas-list       = {thanks},
 }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM odds and ends                                                %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%</plain>
%    \end{macrocode}
%
%
%
% \section{The AIP class}
%
%
%    This layout corresponds to the AIP 8x11in proceeding
%    class. Authors are run together in a single block followed by all
%    addresses with marking linking them back to the author names.
%
%    \begin{macrocode}
%<*aip>
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM measure setup                                                %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\setlength\parindent{12pt}

\DeclareInstance{measure}{fmmatter}{relative}
  {leftmargin-width = \parindent, rightmargin-width=\parindent}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM Text Area setup                                              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareFMArea{title}
 {
  area-required-boolean    = true,
  area-bb-skip             = 0.75in,
  text-font                = \fontsize{18}{19}\bfseries,
  text-justification-setup = center,
 }


\DeclareFMArea{authors}
 {
  area-required-boolean    = true,
  area-measure-setup       = fmmatter,
  area-bb-skip             = 34pt,
  text-font                = \fontsize{14}{15}\normalfont
                             \setlength\lineskip{0pt},        % doesn't belong here!
  text-justification-setup = center,
 }

\DeclareFMArea{addresses}
 {
  area-required-boolean    = true,
  area-measure-setup       = fmmatter,
  area-bb-skip             = 28pt,
  text-font                = \fontsize{10}{11}\itshape,
  text-justification-setup = center,
 }

\DeclareFMArea{date}
 {
  area-required-boolean    = false,
  area-measure-setup       = fmmatter,
  area-bb-skip             = 24pt,
  text-font                = \fontsize{18}{18}\normalfont,
  text-justification-setup = raggedright,
 }


\DeclareFMArea{fnotes}
 {
  area-required-boolean    = false,
  area-bb-skip             = 10pt,
  text-font                = \fontsize{8}{10}\normalfont,
  text-justification-setup = flushleft,
 }


\DeclareFMArea{abstract}
 {
  area-required-boolean    = true,
  area-measure-setup       = fmmatter,
  area-bb-skip             = 28pt,
  head-font                = \fontsize{9}{10}\bfseries,
  head-text                = Abstract,
  head-format              = #1.,
  head-text-h-skip         = 6pt,
  text-font                = \fontsize{9}{10}\normalfont,
  text-justification-setup = default,
%  text-pshape-setup        = ltriangle,
  text-firstindent-boolean = false,
 }




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM Text Marker setup                                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareFMMarker{fnotes}
 {
   marker-type    = \arabic,
   default-format = \textsuperscript{#1},
 }


\DeclareFMMarker{addresses}
 {
   marker-type    = \fnsymbol,
   default-format = \textsuperscript{#1},
 }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM authorinfo setup                                             %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareFMKeyword{authorinfo}{name}
 {
  value-required-boolean = true,
  value-targetarea-id    = authors,
  value-format           = \mbox{#1},
 }

\DeclareFMKeyword{authorinfo}{email}
 {
  value-required-boolean = false,
  value-targetarea-id    = fnotes,
  value-format           = \texttt{#1},
  marker-id              = fnotes,
  marker-sourcearea-id   = authors,
 }

\DeclareFMKeyword{authorinfo}{homepage}
 {
  value-required-boolean = false,
  value-targetarea-id    = fnotes,
  value-format           = \texttt{#1},
  value-combine-boolean  = false,
  marker-id              = fnotes,
  marker-sourcearea-id   = authors,
 }

\DeclareFMKeyword{authorinfo}{thanks}
 {
  value-required-boolean = false,
  value-targetarea-id    = fnotes,
  value-combine-boolean  = false,
  marker-sourcearea-id   = authors,
  marker-id              = fnotes,
 }

\DeclareFMKeyword{authorinfo}{address}
 {
  value-required-boolean = true,
  value-targetarea-id    = addresses,
  value-format           = #1,
  value-combine-boolean  = true,
  marker-id              = addresses,
  marker-sourcearea-id   = authors,
 }

\DeclareFMKeyword{authorinfo}{altaddress}
 {
  value-required-boolean = false,
  value-targetarea-id    = addresses,
  value-combine-boolean  = true,
  marker-sourcearea-id   = authors,
  marker-id              = addresses,
 }




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM articleinfo setup                                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareFMKeyword{articleinfo}{title}
 {
  value-required-boolean = true,
  value-format           = \textbf{#1},
  value-combine-boolean  = false,
  value-targetarea-id    = title,
  marker-id              = ,
 }

\DeclareFMKeyword{articleinfo}{subtitle}
 {
  value-required-boolean = false,
  value-targetarea-id    = title,
  value-combine-boolean  = false,
  marker-id              = ,
 }

\DeclareFMKeyword{articleinfo}{shorttitle}
 {
  value-required-boolean = false,
 }

\DeclareFMKeyword{articleinfo}{thanks}
 {
  value-required-boolean = false,
  value-targetarea-id    = fnotes,
  value-combine-boolean  = false,
  marker-id              = fnotes,
  marker-sourcearea-id   = title,
 }

\DeclareFMKeyword{articleinfo}{abstract}
 {
  value-required-boolean = true,
  value-targetarea-id    = abstract,
  value-combine-boolean  = false,
  marker-id              = ,
 }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM element separation setup                                     %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareFMObjectFormat{*}     {marker!fnotes}{\textsuperscript{#1}}
\DeclareFMObjectFormat{fnotes}{marker!fnotes}{#1.}

\DeclareFMObjectSep{title}{*}            {marker!fnotes}{\,}
\DeclareFMObjectSep{title}{marker!fnotes}{marker!fnotes}{\textsuperscript{,}}
\DeclareFMObjectSep{title}{marker!fnotes}{*}            {}

\DeclareFMObjectSep{authors}{START} {key!name}{}
\DeclareFMObjectSep{authors}{*}     {key!name}{\FMAuthorSeparation}
\DeclareFMObjectSep{authors}{*}     {END}     {}

\DeclareFMObjectSep{authors}{*}            {marker!fnotes}{\,}
\DeclareFMObjectSep{authors}{marker!fnotes}{marker!fnotes}{\textsuperscript{,}}
\DeclareFMObjectSep{authors}{marker!fnotes}{*}            {}

\DeclareFMObjectSep{authors}{*}               {marker!addresses}{\,}
\DeclareFMObjectSep{authors}{marker!addresses}{marker!addresses}{\textsuperscript{,}}
\DeclareFMObjectSep{authors}{marker!addresses}{*}               {}

\DeclareFMObjectSep{authors}{marker!addresses}{marker!fnotes}{\textsuperscript{,}}
\DeclareFMObjectSep{authors}{marker!fnotes}{marker!addresses}{\textsuperscript{,}}
\DeclareFMObjectSep{authors}{*}               {*}            {\space }


\DeclareFMObjectSep{addresses}{START}      {marker!addresses}{}
\DeclareFMObjectSep{addresses}{*}          {marker!addresses}{\\}
\DeclareFMObjectSep{altaddresses}{START}   {marker!addresses}{}
\DeclareFMObjectSep{altaddresses}{*}       {marker!addresses}{\\}


\DeclareFMObjectSep{fnotes}{START}        {*}     {}
\DeclareFMObjectSep{fnotes}{marker!fnotes}{*}     {\space}
\DeclareFMObjectSep{fnotes}{*}            {*}     {\endgraf}
\DeclareFMObjectSep{fnotes}{*}            {END}   {\strut\endgraf}


\DeclareFMObjectSep{abstract}{SUB}           {marker!fnotes}{\unskip}
\DeclareFMObjectSep{abstract}{marker!fnotes} {SUB}          {}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM title setup                                                  %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareInstance{titlesetup}{maketitle}{std}{
   articleinfo-keyword-list = {title,thanks,abstract},
   authorinfo-keyword-list  = {name,email,homepage,thanks,address},
%   top-areas-list      = {title},
%   author-areas-list   = {authors,addresses},
%   bottom-areas-list   = {abstract},
   top-areas-list      = {title,authors,addresses,abstract},
   footins-areas-list  = {fnotes},
   title-post-v-skip   = 2pc,
 }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM odds and ends                                                %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\def\thanks{\dothanks{fnotes}{thanks}{fnotes}}

%</aip>
%    \end{macrocode}
%
%
%
% \section{The ARLO class}
%
%    In this class the authors are sorted by address and below each
%    address we have the emails (if available). A bit questionable
%    since one has to guess which email belongs to which author but
%    that is the way the ARLO journal specifications are.
%
%    \begin{macrocode}
%<*arlo>
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM title setup                                                  %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\DeclareInstance{titlesetup}{maketitle}{authorbyaddress}{
   articleinfo-keyword-list = {title,thanks,subtitle,abstract},
   authorinfo-keyword-list  = {name,email,homepage,thanks,address,altaddress},
   top-areas-list           = {title,subtitle},
   author-areas-list        = {authors,addresses,altaddresses},
   bottom-areas-list        = {abstract},
   footins-areas-list       = {thanks},
 }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM Text Area setup                                              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\DeclareFMArea{title}
 {
  area-required-boolean    = true,
  text-font                = \fontsize{18}{19}\bfseries,
  text-justification-setup = center,
 }

\DeclareFMArea{subtitle}
 {
  area-bb-skip             = 15pt,
  area-required-boolean    = false,
%  head-font                = \fontsize{16}{17}\bfseries,
%  head-text                = Subtitle,
%  head-format              = #1,
%  head-text-h-skip         = 6pt plus 2pt,
  text-font                = \fontsize{12}{13}\normalfont,
  text-justification-setup = center,
 }

\DeclareFMArea{authors}
 {
  area-required-boolean    = true,
  area-bb-skip             = 22pt,
  text-font                = \fontsize{10}{11}\bfseries,
  text-justification-setup = center,
 }

\DeclareFMArea{addresses}
 {
  area-required-boolean    = true,
  area-bb-skip             = 14pt,
  text-font                = \fontsize{8}{9}\normalfont,
  text-justification-setup = center,
 }

\DeclareFMArea{altaddresses}
 {
  area-required-boolean = false,
  area-bb-skip             = 9pt,
  text-font                = \fontsize{8}{9}\itshape,
  text-justification-setup = center,
 }

\DeclareFMArea{abstract}
 {
  area-bb-skip          = 32pt,
  area-required-boolean = true,
  head-font        = \fontsize{10}{11}\bfseries,
  head-text        = Abstract,
  head-format      = #1:,
  head-text-h-skip = 6pt plus 2pt,
  text-font        = \fontsize{10}{11}\normalfont,
  text-justification-setup = adjust,
  text-firstindent-boolean = false,
 }

\DeclareFMArea{date}
 {
  area-bb-skip          = 32pt,
  area-required-boolean = true,
  text-font                = \fontsize{16}{18}\normalfont,
  text-justification-setup = center,
 }

\DeclareFMArea{thanks}
 {
  area-bb-skip       = 10pt,
  text-font                = \fontsize{8}{10}\normalfont,
  text-justification-setup = flushleft,
 }



\DeclareFMMarker{addresses}
 {
   marker-type    = \fnsymbol,
   default-format = \textsuperscript{\normalfont#1},
 }



\DeclareFMMarker{thanks}
 {
   marker-type   = \arabic,
   default-format = \textsuperscript{\normalfont#1},
 }


%\DeclareFMObjectSep{authors}{START}        {key!name}  {}
\DeclareFMObjectSep{authors}{*}{key!name}
  {\UseTemplate{XFMobjectsep}{std}
      { area-id = authors,
        keyword-id = name,
        first-action       = {},
        medial-action      = {,\space  },
        last-of-two-action = {\space  and\space  },
        last-action        = {,\space  and\space  },
      }}
\DeclareFMObjectSep{authors}{*}            {END}       {}

\DeclareFMObjectSep{authors}{marker!thanks}{*}            {\textsuperscript{)}}

\DeclareFMObjectSep{authors}{*}               {marker!addresses}{\,}
\DeclareFMObjectSep{authors}{marker!addresses}{marker!addresses}{\textsuperscript{,}}
\DeclareFMObjectSep{authors}{marker!addresses}{*}               {\textsuperscript{)}}

\DeclareFMObjectSep{authors}{marker!addresses}{marker!thanks}{\textsuperscript{,}}

\DeclareFMObjectSep{authors}{*}            {*}            {\space }

\DeclareFMObjectSep{authors}{*}            {marker!thanks}{\,}
\DeclareFMObjectSep{authors}{marker!thanks}{*}            {\textsuperscript{)}}
\DeclareFMObjectSep{authors}{marker!thanks}{marker!thanks}{\textsuperscript{,}}

\DeclareFMObjectSep{title}{*}            {marker!thanks}{\,}
\DeclareFMObjectSep{title}{marker!thanks}{*}            {\textsuperscript{)}}
\DeclareFMObjectSep{title}{marker!thanks}{marker!thanks}{\textsuperscript{,}}

\DeclareFMObjectSep{subtitle}{*}            {marker!thanks}{\,}
\DeclareFMObjectSep{subtitle}{marker!thanks}{*}            {\textsuperscript{)}}
\DeclareFMObjectSep{subtitle}{marker!thanks}{marker!thanks}{\textsuperscript{,}}

\DeclareFMObjectSep{abstract}{*}            {marker!thanks}{\,}
\DeclareFMObjectSep{abstract}{marker!thanks}{*}            {\textsuperscript{)}}
\DeclareFMObjectSep{abstract}{marker!thanks}{marker!thanks}{\textsuperscript{,}}


\DeclareFMObjectSep{addresses}{START}      {marker!addresses}{}
\DeclareFMObjectSep{addresses}{*}          {marker!addresses}{\\}
%\DeclareFMObjectSep{altaddresses}{START}      {key!email}{}
%\DeclareFMObjectSep{altaddresses}{*}          {key!email}{, }

\DeclareFMObjectSep{altaddresses}{*}{key!email}
  {\UseTemplate{XFMobjectsep}{std}
      { area-id = altaddresses,
        keyword-id = email,
        first-action       = {},
        medial-action      = {,\space  },
        last-of-two-action = {\space  \textup{and}\space  },
        last-action        = {,\space  \textup{and}\space  },
      }}


\DeclareFMObjectSep{thanks} {START}        {*}     {}
\DeclareFMObjectSep{thanks} {marker!thanks}{*}     {\textsuperscript{)}\space}
\DeclareFMObjectSep{thanks} {*}            {*}     {\endgraf}
\DeclareFMObjectSep{thanks} {*}            {END}   {\strut\endgraf}


\DeclareFMObjectSep{title}{*}{key!subtitle}             {\\}





\DeclareFMKeyword{authorinfo}{name}
 {
  value-required-boolean = true,
  value-targetarea-id    = authors,
  marker-id              = ,
  value-format           = \textbf{#1},
 }


\DeclareFMKeyword{authorinfo}{homepage}
 {
  value-required-boolean = false,
  value-targetarea-id    = thanks,
  marker-id              = thanks,
  value-format           = \texttt{#1},
  value-combine-boolean  = true,
 }

\DeclareFMKeyword{authorinfo}{thanks}
 {
  value-required-boolean = false,
  value-targetarea-id    = thanks,
  marker-id              = thanks,
  value-combine-boolean  = false,
 }

\DeclareFMKeyword{authorinfo}{thanks2}
 {
  value-required-boolean = false,
  value-targetarea-id    = thanks,
  marker-id              = thanks,
  value-combine-boolean  = false,
 }

\DeclareFMKeyword{authorinfo}{altaddress}
 {
  value-required-boolean = false,
  value-targetarea-id    = thanks,
  marker-id              = thanks,
  value-combine-boolean  = true,
 }

\DeclareFMKeyword{authorinfo}{address}
 {
  value-required-boolean = true,
  value-targetarea-id    = addresses,
  marker-id              = ,
  value-format           = \textsc{#1},
  value-combine-boolean  = false,
 }

\DeclareFMKeyword{authorinfo}{email}
 {
  value-required-boolean = false,
  value-targetarea-id    = altaddresses,
  marker-id              = ,
%  value-format           = \texttt{#1},
 }




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\DeclareFMKeyword{articleinfo}{title}
 {
  value-required-boolean = true,
  value-targetarea-id    = title,
  marker-id              = ,
  value-combine-boolean  = false,
 }
\DeclareFMKeyword{articleinfo}{subtitle}
 {
  value-required-boolean = false,
  value-targetarea-id    = subtitle,
  marker-id              = ,
  value-combine-boolean  = false,
 }
\DeclareFMKeyword{articleinfo}{short-title}
 {
  value-required-boolean = false,
  value-targetarea-id    = title,
  marker-id              = ,
  value-combine-boolean  = false,
 }

\DeclareFMKeyword{articleinfo}{thanks}
 {
  value-required-boolean = false,
  marker-sourcearea-id   = title,
  value-targetarea-id    = thanks,
  marker-id              = thanks,
  value-combine-boolean  = false,
 }

\DeclareFMKeyword{articleinfo}{abstract}
 {
  value-required-boolean = false,
  value-targetarea-id    = abstract,
  marker-id              = ,
  value-combine-boolean  = false,
 }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM odds and ends                                                %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\def\thanks{\dothanks{thanks}{thanks}{thanks}}
%</arlo>
%    \end{macrocode}
%
%
%
% \section{The TUB class}
%
%    This is a bit like the Tugboat layout except that the test file
%    isn't using twocolumn mode. And of course the strange triangle in
%    the abstract is not part of the TUB layout, it is only there
%    cause i wanted to test the galley features.
%
%    \begin{macrocode}
%<*tub>
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM measure setup                                                %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareInstance{measure}{abstract}{relative}
  {leftmargin-width = 24pt, rightmargin-width=24pt}

\DeclareInstance{measure}{authordetails}{absolute}
  {leftmargin-width = 48pt, rightmargin-width=0pt}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM Text Area setup                                              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareFMArea{title}
 {
  area-required-boolean    = true,
  area-bb-skip             = 0pt,
  text-font                = \fontsize{10}{12}\normalfont,
  text-justification-setup = flushleft,
 }

\DeclareFMArea{subtitle}
 {
  area-required-boolean    = false,
  area-bb-skip             = 12pt,
  text-font                = \fontsize{10}{12}\normalfont,
  text-justification-setup = flushleft,
 }

\DeclareFMArea{authors}
 {
  area-required-boolean    = true,
  area-bb-skip             = 12pt,
  text-font                = \fontsize{10}{12}\normalfont,
  text-justification-setup = raggedright,
 }

\DeclareFMArea{abstract}
 {
  area-required-boolean    = true,
  area-measure-setup       = abstract,
  area-bb-skip             = 32pt,
  head-font                = \fontsize{10}{12}\bfseries,
  head-text                = Abstract,
  head-format              = #1:,
  head-text-h-skip         = 6pt,
  text-font                = \fontsize{10}{12}\normalfont,
  text-justification-setup = default,
  text-pshape-setup        = ltriangle,
  text-firstindent-boolean = false,
 }


\DeclareFMArea{authordetails}
 {
  area-required-boolean    = true,
  area-measure-setup       = authordetails,
  area-bb-skip             =32pt,
  text-font                = \fontsize{10}{12}\normalfont,
  text-justification-setup = flushleft,
 }

\DeclareFMArea{thanks}
 {
  area-required-boolean    = false,
  area-bb-skip             = 10pt,
  text-font                = \fontsize{8}{10}\normalfont,
  text-justification-setup = raggedright,
 }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM Text Marker setup                                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareFMMarker{thanks}
 {
   marker-type    = \arabic,
   default-format = \textsuperscript{\normalfont#1},
 }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM authorinfo setup                                             %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareFMKeyword{authorinfo}{name}
 {
  value-required-boolean = true,
  value-targetarea-id    = authors,
  value-format           = #1,
  marker-id              = ,
  value-targetarea-id2   = authordetails,
  marker-id2             = ,
 }

\DeclareFMKeyword{authorinfo}{thanks}
 {
  value-required-boolean = false,
  value-targetarea-id    = thanks,
  marker-id              = thanks,
  value-combine-boolean  = false,
 }

\DeclareFMKeyword{authorinfo}{thanks2}
 {
  value-required-boolean = false,
  value-targetarea-id    = thanks,
  marker-id              = thanks,
  value-combine-boolean  = false,
 }

\DeclareFMKeyword{authorinfo}{altaddress}
 {
  value-required-boolean = false,
  value-targetarea-id    = ,
 }

\DeclareFMKeyword{authorinfo}{address}
 {
  value-required-boolean = true,
  value-targetarea-id    = authordetails,
  marker-id              = ,
  value-format           = \textsc{#1},
  value-combine-boolean  = false,
 }

\DeclareFMKeyword{authorinfo}{email}
 {
  value-required-boolean = false,
  value-targetarea-id    = authordetails,
  marker-id              = ,
  value-format           = \texttt{Email:\space #1},
 }

\DeclareFMKeyword{authorinfo}{homepage}
 {
  value-required-boolean = false,
  value-targetarea-id    = authordetails,
  marker-id              = ,
  value-format           = \texttt{Url:\space #1},
  value-combine-boolean  = false,
 }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM articleinfo setup                                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareFMKeyword{articleinfo}{title}
 {
  value-required-boolean = true,
  value-targetarea-id    = title,
  marker-id              = ,
  value-combine-boolean  = false,
  value-format           = \textbf{#1},
 }
\DeclareFMKeyword{articleinfo}{subtitle}
 {
  value-required-boolean = false,
  value-targetarea-id    = title,
  marker-id              = ,
  value-combine-boolean  = false,
 }
\DeclareFMKeyword{articleinfo}{short-title}
 {
  value-required-boolean = false,
  value-targetarea-id    = title,
  marker-id              = ,
  value-combine-boolean  = false,
 }

\DeclareFMKeyword{articleinfo}{thanks}
 {
  value-required-boolean = false,
  value-targetarea-id    = thanks,
  marker-id              = thanks,
  marker-sourcearea-id   = title,
  value-combine-boolean  = false,
 }

\DeclareFMKeyword{articleinfo}{abstract}
 {
  value-required-boolean = false,
  value-targetarea-id    = abstract,
  marker-id              = ,
  value-combine-boolean  = false,
 }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM elementseparation setup                                      %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\DeclareFMObjectSep
  {authors}{START}        {key!name}     {}
\DeclareFMObjectSep
  {authors}{*}            {key!name}     {\FMAuthorSeparation}
\DeclareFMObjectSep
  {authors}{*}            {END}          {}

\DeclareFMObjectSep
  {authors}{*}            {marker!thanks}{\,}
\DeclareFMObjectSep
  {authors}{marker!thanks}{marker!thanks}{\textsuperscript{,}}
\DeclareFMObjectSep
  {authors}{marker!thanks}{*}            {\textsuperscript{)}}



\DeclareFMObjectSep
  {thanks} {START}        {*}     {}
\DeclareFMObjectSep
  {thanks} {marker!thanks}{*}     {\textsuperscript{)}\space}
\DeclareFMObjectSep
  {thanks} {*}            {*}     {\endgraf}
\DeclareFMObjectSep
  {thanks} {*}            {END}   {\strut\endgraf}


\DeclareFMObjectSep
  {title}{*}            {marker!thanks}{\,}
\DeclareFMObjectSep
  {title}{marker!thanks}{marker!thanks}{\textsuperscript{,}}
\DeclareFMObjectSep
  {title}{marker!thanks}{*}            {\textsuperscript{)}}
\DeclareFMObjectSep
  {title}{*}{key!subtitle}             {\\}


\DeclareFMObjectSep
  {authordetails}{*}            {*}          {\\}
\DeclareFMObjectSep
  {authordetails}{START}        {*}          {}
\DeclareFMObjectSep
  {authordetails}{*}          {END}          {}
\DeclareFMObjectSep
  {authordetails}{START}  {key!name}
                                 {\noindent\llap{\textbullet\space}}
\DeclareFMObjectSep
  {authordetails}{*}      {key!name}
                                 {\\[3pt]\noindent\llap{\textbullet\space}}


\DeclareFMObjectSep{abstract}{SUB}           {marker!thanks}      {\unskip}
\DeclareFMObjectSep{abstract}{marker!thanks} {SUB}    {\textsuperscript{)}}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM title setup                                                  %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareInstance{titlesetup}{maketitle}{std}{
   articleinfo-keyword-list = {title,thanks,abstract},
   authorinfo-keyword-list  = {name,email,homepage,thanks,address},
   top-areas-list           = {title,authors,abstract},
   footins-areas-list       = {thanks},
   end-areas-list           = {authordetails},
 }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM odds and ends                                                %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\thanks{\dothanks{thanks}{thanks}{thanks}}

%</tub>
%    \end{macrocode}
%
%
%
% \section{The Wiley class}
%    This layout is modeled after a set of journals from Wiley \&
%    Son. As you can see it shows a problem with the footnotes
%    numbering which i haven't yet tackled.
%
%    The interesting part is that some information (the biography of
%    the authors) including the pictures show up at the very end of
%    the document.
%    \begin{macrocode}
%<*wiley>
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM measure setup                                                %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\setlength\parindent{12pt}

\DeclareInstance{measure}{fmmatter}{relative}
  {leftmargin-width = \parindent, rightmargin-width=\parindent}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM Text Area setup                                              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareFMArea{title}
 {
  area-required-boolean    = true,
  area-bb-skip             = 0.75in,
  text-font                = \fontsize{18}{19}\bfseries,
  text-justification-setup = center,
 }


\DeclareFMArea{authors}
 {
  area-required-boolean    = true,
  area-measure-setup       = fmmatter,
  area-bb-skip             = 34pt,
  text-font                = \fontsize{14}{15}\normalfont
                             \setlength\lineskip{0pt},        % doesn't belong here!
  text-justification-setup = center,
 }

\DeclareFMArea{addresses}
 {
  area-required-boolean    = true,
  area-measure-setup       = fmmatter,
  area-bb-skip             = 28pt,
  text-font                = \fontsize{10}{11}\itshape,
  text-justification-setup = center,
 }

\DeclareFMArea{date}
 {
  area-required-boolean    = false,
  area-measure-setup       = fmmatter,
  area-bb-skip             = 24pt,
  text-font                = \fontsize{18}{18}\normalfont,
  text-justification-setup = raggedright,
 }


\DeclareFMArea{fnotes}
 {
  area-required-boolean    = false,
  area-bb-skip             = 10pt,
  text-font                = \fontsize{8}{10}\normalfont,
  text-justification-setup = flushleft,
 }


\DeclareFMArea{abstract}
 {
  area-required-boolean    = true,
  area-measure-setup       = fmmatter,
  area-bb-skip             = 28pt,
  head-font                = \fontsize{9}{10}\bfseries,
  head-text                = Abstract,
  head-format              = #1.,
  head-text-h-skip         = 6pt,
  text-font                = \fontsize{9}{10}\normalfont,
  text-justification-setup = default,
%  text-pshape-setup        = ltriangle,
  text-firstindent-boolean = false,
 }


\DeclareFMArea{biography}
 {
  area-required-boolean    = true,
  area-bb-skip             = 28pt,
  head-font                = \fontsize{12}{14}\bfseries,
  head-text                = Biographies,
  head-justification-setup = flushleft,
  head-format              = \noindent#1,       %bug
  head-text-bb-skip        = 14pt,
  text-font                = \fontsize{9}{10}\normalfont,
  text-justification-setup = default,
  text-pshape-setup        = ltriangle,
  text-firstindent-boolean = false,
 }




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM Text Marker setup                                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareFMMarker{fnotes}
 {
   marker-type    = \arabic,
   default-format = \textsuperscript{#1},
 }


\DeclareFMMarker{addresses}
 {
   marker-type    = \fnsymbol,
   default-format = \textsuperscript{#1},
 }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM authorinfo setup                                             %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareFMKeyword{authorinfo}{name}
 {
  value-required-boolean = true,
  value-targetarea-id    = authors,
  value-format           = \mbox{#1},
  value-targetarea-id2   = biography,
  value-format2          = \mbox{\bfseries#1:},
 }

\DeclareFMKeyword{authorinfo}{email}
 {
  value-required-boolean = false,
  value-targetarea-id    = fnotes,
  value-format           = \texttt{#1},
  marker-id              = fnotes,
  marker-sourcearea-id   = authors,
 }


\DeclareFMKeyword{authorinfo}{thanks}
 {
  value-required-boolean = false,
  value-targetarea-id    = fnotes,
  value-combine-boolean  = false,
  marker-sourcearea-id   = authors,
  marker-id              = fnotes,
 }

\DeclareFMKeyword{authorinfo}{address}
 {
  value-required-boolean = true,
  value-targetarea-id    = addresses,
  value-format           = #1,
  value-combine-boolean  = true,
  marker-id              = addresses,
  marker-sourcearea-id   = authors,
 }


\DeclareFMKeyword{authorinfo}{picture}
 {
  value-required-boolean = false,
  value-targetarea-id    = biography,
  value-format           =
     {\includegraphics[width=1in]{#1}},
 }


\DeclareFMKeyword{authorinfo}{biography}
 {
  value-required-boolean = true,
  value-targetarea-id    = biography,
 }




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM articleinfo setup                                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareFMKeyword{articleinfo}{title}
 {
  value-required-boolean = true,
  value-format           = \textbf{#1},
  value-combine-boolean  = false,
  value-targetarea-id    = title,
  marker-id              = ,
 }

\DeclareFMKeyword{articleinfo}{subtitle}
 {
  value-required-boolean = false,
  value-targetarea-id    = title,
  value-combine-boolean  = false,
  marker-id              = ,
 }

\DeclareFMKeyword{articleinfo}{shorttitle}
 {
  value-required-boolean = false,
 }

\DeclareFMKeyword{articleinfo}{thanks}
 {
  value-required-boolean = false,
  value-targetarea-id    = fnotes,
  value-combine-boolean  = false,
  marker-id              = fnotes,
  marker-sourcearea-id   = title,
 }

\DeclareFMKeyword{articleinfo}{abstract}
 {
  value-required-boolean = true,
  value-targetarea-id    = abstract,
  value-combine-boolean  = false,
  marker-id              = ,
 }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM element separation setup                                     %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareFMObjectFormat{*}     {marker!fnotes}{\textsuperscript{#1}}
\DeclareFMObjectFormat{fnotes}{marker!fnotes}{#1.}

\DeclareFMObjectSep{title}{*}            {marker!fnotes}{\,}
\DeclareFMObjectSep{title}{marker!fnotes}{marker!fnotes}{\textsuperscript{,}}
\DeclareFMObjectSep{title}{marker!fnotes}{*}            {}

\DeclareFMObjectSep{authors}{START} {key!name}{}
\DeclareFMObjectSep{authors}{*}     {key!name}{\FMAuthorSeparation}
\DeclareFMObjectSep{authors}{*}     {END}     {}

\DeclareFMObjectSep{authors}{*}            {marker!fnotes}{\,}
\DeclareFMObjectSep{authors}{marker!fnotes}{marker!fnotes}{\textsuperscript{,}}
\DeclareFMObjectSep{authors}{marker!fnotes}{*}            {}

\DeclareFMObjectSep{authors}{*}               {marker!addresses}{\,}
\DeclareFMObjectSep{authors}{marker!addresses}{marker!addresses}{\textsuperscript{,}}
\DeclareFMObjectSep{authors}{marker!addresses}{*}               {}

\DeclareFMObjectSep{authors}{marker!addresses}{marker!fnotes}{\textsuperscript{,}}
\DeclareFMObjectSep{authors}{marker!fnotes}{marker!addresses}{\textsuperscript{,}}
\DeclareFMObjectSep{authors}{*}               {*}            {\space }


\DeclareFMObjectSep{addresses}{START}      {marker!addresses}{}
\DeclareFMObjectSep{addresses}{*}          {marker!addresses}{\\}
\DeclareFMObjectSep{altaddresses}{START}   {marker!addresses}{}
\DeclareFMObjectSep{altaddresses}{*}       {marker!addresses}{\\}


\DeclareFMObjectSep{fnotes}{START}        {*}     {}
\DeclareFMObjectSep{fnotes}{marker!fnotes}{*}     {\space}
\DeclareFMObjectSep{fnotes}{*}            {*}     {\endgraf}
\DeclareFMObjectSep{fnotes}{*}            {END}   {\strut\endgraf}


\DeclareFMObjectSep{abstract}{SUB}           {marker!fnotes}{\unskip}
\DeclareFMObjectSep{abstract}{marker!fnotes} {SUB}          {}

\RequirePackage{multicol}
\DeclareFMObjectSep{biography}{START}{*}   {\begin{multicols}2}
\DeclareFMObjectSep{biography}{*}{END}     {\end{multicols}}

\DeclareFMObjectSep{biography}{*}{key!picture}   {\endgraf\vspace{0pt
    plus 2pt}\noindent}
\DeclareFMObjectSep{biography}{*}{key!name}   {\hspace{6pt}}
\DeclareFMObjectSep{biography}{key!name}{*}   {\hspace{6pt}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM title setup                                                  %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareRestrictedTemplate{titlesetup}{std}{special}{
   articleinfo-keyword-list = {title,subtitle,abstract},
   authorinfo-keyword-list  = {picture,name,biography,homepage,thanks,address},
}

\DeclareInstance{titlesetup}{maketitle}{special}{
   top-areas-list      = {title,authors,addresses,abstract},
%   top-areas-list      = {title},
%   author-areas-list   = {authors,addresses},
%   bottom-areas-list   = {abstract},
   footins-areas-list  = {fnotes},
   title-post-v-skip   = 2pc,
   end-areas-list      = {biography},
 }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XFM odds and ends                                                %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\def\thanks{\dothanks{fnotes}{thanks}{fnotes}}

%</wiley>
%    \end{macrocode}
