%
% Copyright (C) 2012 LaTeX3 Project
%

\documentclass{minimal}
\input{regression-test}

\RequirePackage{l3fp-new}

\begin{document}
\START
\AUTHOR{Bruno Le Floch}
\ExplSyntaxOn

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TESTEXP { Logarithm }
  {
    \fp_to_tl:n { ln(nan) } \NEWLINE
    \fp_to_tl:n { ln(inf) } \NEWLINE
    \fp_to_tl:n { ln(-inf) } \NEWLINE
    \fp_to_tl:n { ln(0) } \NEWLINE
    \fp_to_tl:n { ln(-0) } \NEWLINE
    \fp_to_tl:n { ln(1) } \NEWLINE
    \fp_to_tl:n { ln(-1) } \NEWLINE
    \fp_to_tl:n { ln(1e100) } \NEWLINE
    \fp_to_tl:n { ln(1e-100) } \NEWLINE
    \fp_to_tl:n { ln(1234567.891234567) } \NEWLINE
    \fp_to_tl:n { ln(111111.1111111111) } \NEWLINE
    \fp_to_tl:n { ln(222222.2222222222) } \NEWLINE
    \fp_to_tl:n { ln(333333.3333333333) } \NEWLINE
    \fp_to_tl:n { ln(444444.4444444444) } \NEWLINE
    \fp_to_tl:n { ln(555555.5555555555) } \NEWLINE
    \fp_to_tl:n { ln(666666.6666666666) } \NEWLINE
    \fp_to_tl:n { ln(777777.7777777777) } \NEWLINE
    \fp_to_tl:n { ln(888888.8888888888) } \NEWLINE
    \fp_to_tl:n { ln(999999.9999999999) } \NEWLINE
    \fp_to_tl:n { ln(.1234567833274652) } \NEWLINE
    \fp_to_tl:n { ln(.2376458734876423e-1) } \NEWLINE
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TESTEXP { Exponential }
  {
    \fp_to_tl:n { exp(nan) } \NEWLINE
    \fp_to_tl:n { exp(inf) } \NEWLINE
    \fp_to_tl:n { exp(-inf) } \NEWLINE
    \fp_to_tl:n { exp(0) } \NEWLINE
    \fp_to_tl:n { exp(-0) } \NEWLINE
    \fp_to_tl:n { exp(1) } \NEWLINE
    \fp_to_tl:n { exp(-1) } \NEWLINE
    \fp_to_tl:n { exp(1e100) } \NEWLINE
    \fp_to_tl:n { exp(1e-100) } \NEWLINE
    \fp_to_tl:n { exp(1234567.891234567) } \NEWLINE
    \fp_to_tl:n { exp(111111.1111111111) } \NEWLINE
    \fp_to_tl:n { exp(222222.2222222222) } \NEWLINE
    \fp_to_tl:n { exp(333333.3333333333) } \NEWLINE
    \fp_to_tl:n { exp(444444.4444444444) } \NEWLINE
    \fp_to_tl:n { exp(555555.5555555555) } \NEWLINE
    \fp_to_tl:n { exp(666666.6666666666) } \NEWLINE
    \fp_to_tl:n { exp(777777.7777777777) } \NEWLINE
    \fp_to_tl:n { exp(888888.8888888888) } \NEWLINE
    \fp_to_tl:n { exp(999999.9999999999) } \NEWLINE
    \fp_to_tl:n { exp(.1234567833274652) } \NEWLINE
    \fp_to_tl:n { exp(.2376458734876423e-1) } \NEWLINE
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\OMIT
\cs_set:Npn \test:nn #1 #2 { '(#1)^(#2)'~=~\fp_to_tl:n { (#1) ^ (#2) } }
\TIMO


\TESTEXP { Power~special~cases }
  {
    \test:nn {nan} {nan}  \NEWLINE
    \test:nn {nan} {inf}  \NEWLINE
    \test:nn {nan} {-inf} \NEWLINE
    \test:nn {nan} {1}    \NEWLINE
    \test:nn {nan} {-1}   \NEWLINE
    \test:nn {nan} {0}    \NEWLINE
    \test:nn {nan} {-0}   \NEWLINE
    \test:nn {inf} {nan}  \NEWLINE
    \test:nn {inf} {inf}  \NEWLINE
    \test:nn {inf} {-inf} \NEWLINE
    \test:nn {inf} {1}    \NEWLINE
    \test:nn {inf} {-1}   \NEWLINE
    \test:nn {inf} {0}    \NEWLINE
    \test:nn {inf} {-0}   \NEWLINE
    \test:nn {-inf} {nan} \NEWLINE
    \test:nn {-inf} {inf} \NEWLINE
    \test:nn {-inf} {-inf}\NEWLINE
    \test:nn {-inf} {1}   \NEWLINE
    \test:nn {-inf} {-1}  \NEWLINE
    \test:nn {-inf} {0}   \NEWLINE
    \test:nn {-inf} {-0}  \NEWLINE
    \test:nn {1} {nan}    \NEWLINE
    \test:nn {1} {inf}    \NEWLINE
    \test:nn {1} {-inf}   \NEWLINE
    \test:nn {1} {0}      \NEWLINE
    \test:nn {1} {-0}     \NEWLINE
    \test:nn {-1} {nan}    \NEWLINE
    \test:nn {-1} {inf}    \NEWLINE
    \test:nn {-1} {-inf}   \NEWLINE
    \test:nn {-1} {0}      \NEWLINE
    \test:nn {-1} {-0}     \NEWLINE
    \test:nn {0} {nan}    \NEWLINE
    \test:nn {0} {inf}    \NEWLINE
    \test:nn {0} {-inf}   \NEWLINE
    \test:nn {0} {1}      \NEWLINE
    \test:nn {0} {-1}     \NEWLINE
    \test:nn {0} {0}      \NEWLINE
    \test:nn {0} {-0}     \NEWLINE
    \test:nn {-0} {nan}   \NEWLINE
    \test:nn {-0} {inf}   \NEWLINE
    \test:nn {-0} {-inf}  \NEWLINE
    \test:nn {-0} {1}     \NEWLINE
    \test:nn {-0} {-1}    \NEWLINE
    \test:nn {-0} {0}     \NEWLINE
    \test:nn {-0} {-0}    \NEWLINE
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\OMIT
\fp_set:Nn \l_A_fp { -1 }
\TIMO
\TESTEXP { Power~and~minus~one }
  {
    \fp_to_tl:n { -1**2 - \l_A_fp **2 } \NEWLINE
    \fp_to_tl:n { \c_minus_one **2 } \NEWLINE
  }

\iffalse
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TESTEXP { Power }
  {
    \test:nn {1.4142135623730951e3} {1.7320508075688772e4} \NEWLINE
    \test:nn {1.7320508075688772e5} {1.4142135623730951e4} \NEWLINE
    \test:nn {2.2360679774997898e9}  {2.4494897427831779e2} \NEWLINE
    \test:nn {2.4494897427831779e11} {2.2360679774997898e0} \NEWLINE
    \test:nn {2.6457513110645907e13} {2.8284271247461903e1} \NEWLINE
    \test:nn {2.8284271247461903e15} {1.7320508075688772} \NEWLINE
    \test:nn {3.1622776601683795e19} {1.4142135623730951} \NEWLINE
    \test:nn {2.2360679774997898} {3.1622776601683795e2} \NEWLINE
    \test:nn {1.4142135623730951} {2.6457513110645907e4} \NEWLINE
    \test:nn {1.2} {3.4} \NEWLINE
    \test:nn {0.1234567890123456789} {0.9876543210987654321} \NEWLINE
    \test:nn {1234} {4321} \NEWLINE
    \test:nn {13579238576348} {23573948576428} \NEWLINE
    \test:nn {21342.39876238473423} {.9384123239423948238} \NEWLINE
    \test:nn {912392184728736423847} {32324234234325234123124} \NEWLINE
  }
\fi

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\END